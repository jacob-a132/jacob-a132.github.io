<!DOCTYPE html>
<html>
<head>
	<link rel="icon" href="http://simpleicon.com/wp-content/uploads/link-1.png">
	<link rel="stylesheet" type="text/css" href="common.css">
	<link id="pagestyle" rel="stylesheet" type="text/css" href="dark.css">
	<title>My Course Links</title>
</head>
<body>
	<div>
		<right>
			<button id="stylesheet1" > Light Mode </button>
	    	<button id="stylesheet2" > Dark Mode </button>
	    </right>
    	
		<h1>Course Links:</h1>
		<a href="http://www.cs.toronto.edu/~lczhang/321/" target="_blank">CSC321 - Lisa</a>
		<span>http://cs.toronto.edu/~lczhang/321/</span>
		<br><br>
		<a href="https://mcs.utm.utoronto.ca/~358/" target="_blank">CSC358 - Larry/Luit</a>
		<span>https://mcs.utm.utoronto.ca/~358/</span>
		<br><br>
		<a href="https://mcsapps.utm.utoronto.ca/mat402_wiki/index.php" target="_blank">MAT402 - Parker</a>
		<span>https://mcsapps.utm.utoronto.ca/mat402_wiki/index.php</span>
		<br><br>
		<button id="studentLinkButton" type="button">Student page</button>
		<span>https://cslinux.utm.utoronto.ca/~<input id="studentLink" type="text" value="atzorija" /></span>
		<br><br><br><br>
		----------------
		<br><br>
		<customlinks id="customlinks"></customlinks>
		<formz>
		  Link: <input id="newLink" type="text" size="50" name="firstname" value="https://wwww.google.ca">
		  Name: <input id="newLinkName" type="text" name="lastname" value="google">
		  <button id="linkAdd" onclick="addLink()">Add</button>
		</formz>
		<br><br><br><br>
		<h2>Time: <time id="timelabel"></time>%</h2>
		<h2>Date: <date id="daylabel"></date>%, <date id="monthlabel"></date>%, <date id="yearlabel"></date>%</h2>
		<h2>Overall Time: <time id="overalltimelabel"></time>%</h2>
	</div>
	
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">
	// $.get("https://cslinux.utm.utoronto.ca/~atzorija/api/getlinks.php", function(data){
		// console.log(data);
		let data = "google.ca\tgoogle\nutoronto.ca\tutoronto";
		const links = data.split("\n");
		links.forEach(linkData => {
			[link, name] = linkData.split("\t");
			$("#customlinks").append(`<a href="${link}" target="_blank">${name}</a>
				<span>${link}</span>
				<br><br>`);
		});
	// });
	function addLink(){
		const linkUrl = $("#newLink").val();
		const linkName = $("#newLinkName").val();
		$.get(`https://cslinux.utm.utoronto.ca/~atzorija/api/addLink.php?link=${linkUrl}&name=${linkName}`, function(data){
			$("#customlinks").append(`<a href="${linkUrl}" target="_blank">${name}</a>
				<span>${linkName}</span>
				<br><br>`);
		});
	}
</script>
<script type="text/javascript">
	function swapStyleSheet(sheet) {
	    document.getElementById("pagestyle").setAttribute("href", sheet);
	}
	function openStudentUrl() {
		let url = "https://cslinux.utm.utoronto.ca/~" + 
		document.getElementById("studentLink").value;
		window.open(url,'_blank');
	}
	function getSecondsToday() {
	  let d = new Date();
	  return d.getHours() * 3600 + d.getMinutes() * 60 + d.getSeconds();
	}
	function getDaysThisMonth() {
	  let d = new Date();
	  return d.getDate();
	}
	function getMonthsThisYear() {
	  let d = new Date();
	  return d.getMonth() + 1;
	}
	function getYear() {
	  let d = new Date();
	  return d.getYear() - 69;
	}
	function getUnixTime() {
		return Math.round((new Date()).getTime() / 1000);
	}
	let unixDeath = 2147483648;
	function setTime() {
		let dayLength = 3600*24;
		document.getElementById("timelabel").innerHTML = 
			Math.floor(10000*getSecondsToday()/dayLength)/100;
	}
	function setDate() {
		let daysInMonth = 31;
		let monthsInYear = 12;
		let numberOfYears = 69;
		document.getElementById("daylabel").innerHTML = 
			Math.floor(100*getDaysThisMonth()/daysInMonth);
		document.getElementById("monthlabel").innerHTML = 
			Math.floor(100*getMonthsThisYear()/monthsInYear);
		document.getElementById("yearlabel").innerHTML = 
			Math.floor(100*getYear()/numberOfYears);
	}
	function setOverallTime() {
		let overallTime = 100*getUnixTime()/unixDeath;
		document.getElementById("overalltimelabel").innerHTML = 
			// Math.floor(10000*getUnixTime()/unixDeath)/100;
			(overallTime - overallTime % 10**-7).toFixed(13);
	}
	stylesheet1.onclick = function () { swapStyleSheet("light.css") };
	stylesheet2.onclick = function () { swapStyleSheet("dark.css"); };
	document.getElementById("studentLinkButton").onclick = openStudentUrl;
	setTime();
	setDate();
	setOverallTime();
	window.setInterval(setTime, 600);
	window.setInterval(setOverallTime, 2148);
</script>
</html>